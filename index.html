<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–∏–º—É–ª—è—Ç–æ—Ä –†–∞–∑–≤–∏—Ç–∏—è –§–µ–æ–¥–∞</title>
    <style>
        /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞–ª–∏—Å—å –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π */
        :root {
            --primary: #4a752c;
            --secondary: #8a9a5b;
            --dark: #2c3e21;
            --light: #e9f5db;
            --gold: #d4af37;
            --stone: #a9a9a9;
            --wood: #8b4513;
            --ore: #c1440e;
            --villadium: #6a0dad;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232c3e21"/><path d="M0,0 L100,100 M100,0 L0,100" stroke="%233a4b2c" stroke-width="1"/></svg>');
            color: var(--light);
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(43, 58, 32, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        header {
            background: var(--dark);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid var(--gold);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--gold);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(58, 78, 45, 0.8);
            border-bottom: 1px solid var(--secondary);
        }
        
        .time-controls {
            display: flex;
            gap: 10px;
        }
        
        .speed-btn {
            padding: 8px 15px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .speed-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .speed-btn.active {
            background: var(--gold);
            color: var(--dark);
        }
        
        .tabs {
            display: flex;
            background: var(--dark);
            border-bottom: 2px solid var(--gold);
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab:hover {
            background: rgba(106, 142, 74, 0.5);
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            min-height: 500px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .resource-card {
            background: rgba(69, 94, 54, 0.8);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
        }
        
        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .resource-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .resource-name {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: var(--gold);
        }
        
        .resource-value {
            font-size: 1.4rem;
            font-weight: bold;
        }
        
        .stone { color: var(--stone); }
        .wood { color: var(--wood); }
        .ore { color: var(--ore); }
        .villadium { color: var(--villadium); }
        
        .production-section, .building-section, .mining-section {
            background: rgba(58, 78, 45, 0.6);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        h2 {
            color: var(--gold);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
        }
        
        .building-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .building-card {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
        }
        
        .building-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .building-name {
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .building-level {
            background: var(--gold);
            color: var(--dark);
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .building-cost {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .upgrade-btn {
            width: 100%;
            padding: 8px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .upgrade-btn:hover {
            background: var(--secondary);
        }
        
        .upgrade-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        .assignment-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .assign-btn {
            flex: 1;
            padding: 5px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .peasants-info {
            background: rgba(106, 142, 74, 0.6);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .peasants-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--gold);
            margin: 10px 0;
        }
        
        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .recipe-card {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
        }
        
        .recipe-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .recipe-cost {
            margin: 10px 0;
        }
        
        .produce-btn {
            width: 100%;
            padding: 8px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .production-queue {
            margin-top: 30px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .queue-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-bar {
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gold);
            width: 0%;
            transition: width 0.5s;
        }
        
        .mining-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .mining-card {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
        }
        
        .mining-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .mining-name {
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .mining-level {
            background: var(--gold);
            color: var(--dark);
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .mining-assigned {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        
        .mining-controls {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .mining-btn {
            flex: 1;
            padding: 5px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .production-line {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
            margin-bottom: 15px;
        }
        
        .line-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .line-name {
            font-weight: bold;
        }
        
        .recipe-select {
            width: 100%;
            padding: 5px;
            margin-bottom: 10px;
            background: rgba(0, 0, 0, 0.2);
            color: white;
            border: 1px solid var(--secondary);
            border-radius: 5px;
        }
        
        @media (max-width: 768px) {
            .resources-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .building-grid, .recipe-grid, .mining-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>–°–∏–º—É–ª—è—Ç–æ—Ä –†–∞–∑–≤–∏—Ç–∏—è –§–µ–æ–¥–∞</h1>
            <p>–£–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º –¥–æ–º–µ–Ω–æ–º, —Ä–∞–∑–≤–∏–≤–∞–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ –∏ —Ä–∞—Å—à–∏—Ä—è–π—Ç–µ –≤–ª–∞–¥–µ–Ω–∏—è</p>
        </header>
        
        <div class="game-info">
            <div class="time-controls">
                <button class="speed-btn active" data-speed="1">1x</button>
                <button class="speed-btn" data-speed="2">2x</button>
                <button class="speed-btn" data-speed="10">10x</button>
                <button class="speed-btn" data-speed="100">100x</button>
                <button class="speed-btn" data-speed="1000">1000x</button>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="resources">–†–µ—Å—É—Ä—Å—ã</div>
            <div class="tab" data-tab="mining">–î–æ–±—ã—á–∞</div>
            <div class="tab" data-tab="production">–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</div>
            <div class="tab" data-tab="buildings">–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ</div>
            <div class="tab" data-tab="recruitment">–ù–∞–π–º</div>
        </div>
        
        <div class="tab-content active" id="resources-tab">
            <div class="peasants-info">
                <h3>–ö—Ä–µ—Å—Ç—å—è–Ω–µ</h3>
                <div class="peasants-value">30,000</div>
                <div>–°–≤–æ–±–æ–¥–Ω—ã–µ: <span id="free-peasants">30,000</span></div>
            </div>
            
            <h2>–û—Å–Ω–æ–≤–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon stone">‚õèÔ∏è</div>
                    <div class="resource-name">–ö–∞–º–µ–Ω—å</div>
                    <div class="resource-value stone">1,250</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon wood">üå≤</div>
                    <div class="resource-name">–õ–µ—Å</div>
                    <div class="resource-value wood">750</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon ore">üî∂</div>
                    <div class="resource-name">–†—É–¥–∞</div>
                    <div class="resource-value ore">500</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon villadium">üíé</div>
                    <div class="resource-name">–í–∏–ª–ª–∞–¥–∏—É–º</div>
                    <div class="resource-value villadium">100</div>
                </div>
            </div>
            
            <h2>–ú–∞—Ç–µ—Ä–∏–∞–ª—ã</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon">üî•</div>
                    <div class="resource-name">–ñ–µ–ª–µ–∑–æ</div>
                    <div class="resource-value">250</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">üü†</div>
                    <div class="resource-name">–ú–µ–¥—å</div>
                    <div class="resource-value">150</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">‚¨õ</div>
                    <div class="resource-name">–£–≥–æ–ª—å</div>
                    <div class="resource-value">200</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">üß™</div>
                    <div class="resource-name">–ö–∏—Å–ª–æ—Ç–∞</div>
                    <div class="resource-value">50</div>
                </div>
            </div>
            
            <h2>–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon">üî©</div>
                    <div class="resource-name">–°—Ç–∞–ª—å</div>
                    <div class="resource-value">75</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">üíª</div>
                    <div class="resource-name">–≠–ª. –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</div>
                    <div class="resource-value">40</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">üîã</div>
                    <div class="resource-name">–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</div>
                    <div class="resource-value">25</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">‚öôÔ∏è</div>
                    <div class="resource-name">–í–∏–ª–ª. —Ñ–∏–ª—å—Ç—Ä—ã</div>
                    <div class="resource-value">10</div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="mining-tab">
            <div class="mining-section">
                <div class="peasants-info">
                    <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–µ—Å—Ç—å—è–Ω</h3>
                    <div class="peasants-value">30,000</div>
                    <div>–°–≤–æ–±–æ–¥–Ω—ã–µ: <span id="mining-free-peasants">30,000</span></div>
                </div>
                
                <h2>–î–æ–±—ã—á–∞ —Ä–µ—Å—É—Ä—Å–æ–≤</h2>
                <div class="mining-grid">
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">–ö–∞–º–µ–Ω–æ–ª–æ–º–Ω—è</div>
                            <div class="mining-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç –∫–∞–º–µ–Ω—å –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>–ù–∞–∑–Ω–∞—á–µ–Ω–æ:</span>
                                <span id="stone-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>–ú–∞–∫—Å–∏–º—É–º:</span>
                                <span>13,500</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="stone" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="stone" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="stone" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="stone" data-amount="2500">+2500</button>
                        </div>
                    </div>
                    
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">–®–∞—Ö—Ç–∞</div>
                            <div class="mining-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç —Ä—É–¥—É –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>–ù–∞–∑–Ω–∞—á–µ–Ω–æ:</span>
                                <span id="ore-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>–ú–∞–∫—Å–∏–º—É–º:</span>
                                <span>13,500</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="ore" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="ore" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="ore" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="ore" data-amount="2500">+2500</button>
                        </div>
                    </div>
                    
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">–õ–µ—Å–æ–ø–∏–ª–∫–∞</div>
                            <div class="mining-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç –¥—Ä–µ–≤–µ—Å–∏–Ω—É –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —É–≥–æ–ª—å</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>–ù–∞–∑–Ω–∞—á–µ–Ω–æ:</span>
                                <span id="wood-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>–ú–∞–∫—Å–∏–º—É–º:</span>
                                <span>13,500</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="wood" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="wood" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="wood" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="wood" data-amount="2500">+2500</button>
                        </div>
                    </div>
                    
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">–í–∏–ª–ª–∞–¥–∏—É–º–Ω–∞—è —à–∞—Ö—Ç–∞</div>
                            <div class="mining-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç –≤–∏–ª–ª–∞–¥–∏—É–º, —Ä–µ–¥–∫–∏–π —Ä–µ—Å—É—Ä—Å</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>–ù–∞–∑–Ω–∞—á–µ–Ω–æ:</span>
                                <span id="villadium-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>–ú–∞–∫—Å–∏–º—É–º:</span>
                                <span>6,750</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="villadium" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="villadium" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="villadium" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="villadium" data-amount="2500">+2500</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="production-tab">
            <div class="production-section">
                <div class="peasants-info">
                    <h3>–§–∞–±—Ä–∏–∫–∞ (–£—Ä–æ–≤–µ–Ω—å: <span id="factory-level">1</span>)</h3>
                    <div class="peasants-value">30,000</div>
                    <div>–°–≤–æ–±–æ–¥–Ω—ã–µ: <span id="production-free-peasants">30,000</span></div>
                    <div>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏: <span id="production-lines">1</span></div>
                </div>
                
                <h2>–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –ª–∏–Ω–∏–∏</h2>
                <div id="production-lines-container">
                    <div class="production-line">
                        <div class="line-header">
                            <div class="line-name">–õ–∏–Ω–∏—è #1</div>
                        </div>
                        <select class="recipe-select" data-line="0">
                            <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç</option>
                            <option value="steel">–°—Ç–∞–ª—å</option>
                            <option value="electronics">–≠–ª. –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</option>
                            <option value="batteries">–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</option>
                            <option value="filters">–í–∏–ª–ª. —Ñ–∏–ª—å—Ç—Ä—ã</option>
                        </select>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>–ù–∞–∑–Ω–∞—á–µ–Ω–æ –∫—Ä–µ—Å—Ç—å—è–Ω:</span>
                                <span class="line-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                                <span class="line-progress">0%</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-line="0" data-amount="-250">-250</button>
                            <button class="mining-btn" data-line="0" data-amount="-25">-25</button>
                            <button class="mining-btn" data-line="0" data-amount="25">+25</button>
                            <button class="mining-btn" data-line="0" data-amount="250">+250</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="production-section">
                <h2>–†–µ—Ü–µ–ø—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</h2>
                <div class="recipe-grid">
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–°—Ç–∞–ª—å</div>
                            <div class="recipe-output">1 –µ–¥–∏–Ω–∏—Ü–∞</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ñ–µ–ª–µ–∑–æ:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>–£–≥–æ–ª—å:</span>
                                <span>5</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>–í—Ä–µ–º—è –Ω–∞ 250 –∫—Ä–µ—Å—Ç—å—è–Ω:</span>
                            <span>10 —á–∞—Å–æ–≤</span>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–≠–ª. –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</div>
                            <div class="recipe-output">1 –µ–¥–∏–Ω–∏—Ü–∞</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ñ–µ–ª–µ–∑–æ:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>–ú–µ–¥—å:</span>
                                <span>5</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>–í—Ä–µ–º—è –Ω–∞ 250 –∫—Ä–µ—Å—Ç—å–∞–Ω:</span>
                            <span>10 —á–∞—Å–æ–≤</span>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</div>
                            <div class="recipe-output">1 –µ–¥–∏–Ω–∏—Ü–∞</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ö–∏—Å–ª–æ—Ç–∞:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>–ú–µ–¥—å:</span>
                                <span>20</span>
                            </div>
                            <div class="cost-item">
                                <span>–£–≥–æ–ª—å:</span>
                                <span>5</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>–í—Ä–µ–º—è –Ω–∞ 250 –∫—Ä–µ—Å—Ç—å–∞–Ω:</span>
                            <span>10 —á–∞—Å–æ–≤</span>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–í–∏–ª–ª. —Ñ–∏–ª—å—Ç—Ä—ã</div>
                            <div class="recipe-output">1 –µ–¥–∏–Ω–∏—Ü–∞</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–í–∏–ª–ª–∞–¥–∏—É–º:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>–£–≥–æ–ª—å:</span>
                                <span>1</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>–í—Ä–µ–º—è –Ω–∞ 250 –∫—Ä–µ—Å—Ç—å–∞–Ω:</span>
                            <span>10 —á–∞—Å–æ–≤</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="buildings-tab">
            <div class="building-section">
                <h2>–ó–¥–∞–Ω–∏—è —Ñ–µ–æ–¥–∞</h2>
                <div class="building-grid">
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">–ó–∞–º–æ–∫</div>
                            <div class="building-level">–£—Ä. 1</div>
                        </div>
                        <p>–¶–µ–Ω—Ç—Ä —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–µ–æ–¥–æ–º. –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥—Ä—É–≥–∏—Ö –∑–¥–∞–Ω–∏–π —Ä–∞–≤–µ–Ω —É—Ä–æ–≤–Ω—é –∑–∞–º–∫–∞.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>–ö–∞–º–µ–Ω—å:</span>
                                <span>2,000</span>
                            </div>
                            <div class="cost-item">
                                <span>–õ–µ—Å:</span>
                                <span>1,000</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">–£–ª—É—á—à–∏—Ç—å –¥–æ —É—Ä. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">–ö–∞–º–µ–Ω–æ–ª–æ–º–Ω—è</div>
                            <div class="building-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç –∫–∞–º–µ–Ω—å –¥–ª—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–∞ –∏ —É–ª—É—á—à–µ–Ω–∏—è –∑–¥–∞–Ω–∏–π.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>–ö–∞–º–µ–Ω—å:</span>
                                <span>1,500</span>
                            </div>
                            <div class="cost-item">
                                <span>–õ–µ—Å:</span>
                                <span>500</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">–£–ª—É—á—à–∏—Ç—å –¥–æ —É—Ä. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">–®–∞—Ö—Ç–∞</div>
                            <div class="building-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç —Ä—É–¥—É –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –º–µ—Ç–∞–ª–ª–æ–≤.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>–ö–∞–º–µ–Ω—å:</span>
                                <span>1,200</span>
                            </div>
                            <div class="cost-item">
                                <span>–õ–µ—Å:</span>
                                <span>300</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">–£–ª—É—á—à–∏—Ç—å –¥–æ —É—Ä. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">–§–∞–±—Ä–∏–∫–∞</div>
                            <div class="building-level">–£—Ä. 1</div>
                        </div>
                        <p>–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —Å–ª–æ–∂–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>–ö–∞–º–µ–Ω—å:</span>
                                <span>3,000</span>
                            </div>
                            <div class="cost-item">
                                <span>–õ–µ—Å:</span>
                                <span>1,500</span>
                            </div>
                            <div class="cost-item">
                                <span>–°—Ç–∞–ª—å:</span>
                                <span>200</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">–£–ª—É—á—à–∏—Ç—å –¥–æ —É—Ä. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">–õ–µ—Å–æ–ø–∏–ª–∫–∞</div>
                            <div class="building-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç –¥—Ä–µ–≤–µ—Å–∏–Ω—É –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç —É–≥–æ–ª—å.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>–ö–∞–º–µ–Ω—å:</span>
                                <span>800</span>
                            </div>
                            <div class="cost-item">
                                <span>–õ–µ—Å:</span>
                                <span>400</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">–£–ª—É—á—à–∏—Ç—å –¥–æ —É—Ä. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">–í–∏–ª–ª–∞–¥–∏—É–º–Ω–∞—è —à–∞—Ö—Ç–∞</div>
                            <div class="building-level">–£—Ä. 1</div>
                        </div>
                        <p>–î–æ–±—ã–≤–∞–µ—Ç –≤–∏–ª–ª–∞–¥–∏—É–º, —Ä–µ–¥–∫–∏–π —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ—Å—É—Ä—Å.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>–ö–∞–º–µ–Ω—å:</span>
                                <span>2,500</span>
                            </div>
                            <div class="cost-item">
                                <span>–°—Ç–∞–ª—å:</span>
                                <span>100</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">–£–ª—É—á—à–∏—Ç—å –¥–æ —É—Ä. 2</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="recruitment-tab">
            <div class="peasants-info">
                <h3>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫—Ä–µ—Å—Ç—å—è–Ω</h3>
                <div class="peasants-value">30,000</div>
                <div>–°–≤–æ–±–æ–¥–Ω—ã–µ: <span id="recruit-free-peasants">30,000</span></div>
            </div>
            
            <div class="production-section">
                <h2>–ù–∞–π–º –≤–æ–π—Å–∫</h2>
                <div class="recipe-grid">
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–ö—Ä–µ—Å—Ç—å—è–Ω—Å–∫–∞—è –±–∞—Ç–∞–ª–∏—è</div>
                            <div class="recipe-output">30,000 –∫—Ä–µ—Å—Ç—å—è–Ω</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ö—Ä–µ—Å—Ç—å—è–Ω–µ:</span>
                                <span>30,000</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="peasant" data-amount="30000">–ù–∞–Ω—è—Ç—å –±–∞—Ç–∞–ª–∏—é</button>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–ü–æ–º–µ—Å—Ç–Ω–∞—è –±–∞—Ç–∞–ª–∏—è</div>
                            <div class="recipe-output">22,500 –≤–æ–∏–Ω–æ–≤</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ö—Ä–µ—Å—Ç—å—è–Ω–µ:</span>
                                <span>22,500</span>
                            </div>
                            <div class="cost-item">
                                <span>–ö–æ–ø—å—è:</span>
                                <span>100</span>
                            </div>
                            <div class="cost-item">
                                <span>–ñ–µ–ª–µ–∑–æ:</span>
                                <span>50</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="warrior1" data-amount="22500">–ù–∞–Ω—è—Ç—å –±–∞—Ç–∞–ª–∏—é</button>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–î–æ–º–µ–Ω–Ω–∞—è –±–∞—Ç–∞–ª–∏—è</div>
                            <div class="recipe-output">15,000 –≤–æ–∏–Ω–æ–≤</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ö—Ä–µ—Å—Ç—å—è–Ω–µ:</span>
                                <span>15,000</span>
                            </div>
                            <div class="cost-item">
                                <span>–ê–ª–µ–±–∞—Ä–¥—ã:</span>
                                <span>50</span>
                            </div>
                            <div class="cost-item">
                                <span>–°—Ç–∞–ª—å:</span>
                                <span>30</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="warrior2" data-amount="15000">–ù–∞–Ω—è—Ç—å –±–∞—Ç–∞–ª–∏—é</button>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">–ö–æ–ø—å–µ –ª–∞–Ω–¥—Ñ—Ä–∏–¥–∞</div>
                            <div class="recipe-output">7,500 –≤–æ–∏–Ω–æ–≤</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>–ö—Ä–µ—Å—Ç—å—è–Ω–µ:</span>
                                <span>7,500</span>
                            </div>
                            <div class="cost-item">
                                <span>–≠–ª. –∫–æ–ø—å—è:</span>
                                <span>20</span>
                            </div>
                            <div class="cost-item">
                                <span>–°—Ç–∞–ª—å:</span>
                                <span>50</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="warrior3" data-amount="7500">–ù–∞–Ω—è—Ç—å –±–∞—Ç–∞–ª–∏—é</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            resources: {
                stone: 1250,
                wood: 750,
                ore: 500,
                villadium: 100,
                iron: 250,
                copper: 150,
                coal: 200,
                acid: 50,
                steel: 75,
                electronicComponents: 40,
                accumulators: 25,
                villadiumFilters: 10
            },
            peasants: {
                total: 30000,
                free: 30000,
                assigned: {
                    stone: 0,
                    wood: 0,
                    ore: 0,
                    villadium: 0,
                    production: 0
                }
            },
            buildings: {
                castle: 1,
                quarry: 1,
                mine: 1,
                factory: 1,
                sawmill: 1,
                villadiumMine: 1
            },
            productionLines: [
                {
                    recipe: null,
                    assigned: 0,
                    progress: 0
                }
            ],
            army: {
                peasant: 0,
                warrior1: 0,
                warrior2: 0,
                warrior3: 0
            },
            speed: 1
        };
        
        // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫—Ä–µ—Å—Ç—å—è–Ω –ø–æ —É—Ä–æ–≤–Ω—è–º –∑–∞–º–∫–∞ (–∏–∑ CSV)
        const peasantsByCastleLevel = [
            30000, 42000, 42250, 42500, 42750, 43000, 43500, 44000, 44500, 45000,
            46000, 47000, 48000, 49000, 50000, 52000, 54000, 56000, 58000, 60000,
            63000, 66000, 69000, 72000, 75000, 80000, 85000, 90000, 95000, 100000,
            130000, 160000, 190000, 220000, 250000, 300000, 350000, 400000, 450000, 500000
        ];
        
        // –°—Ç–æ–∏–º–æ—Å—Ç—å —É–ª—É—á—à–µ–Ω–∏–π –∑–¥–∞–Ω–∏–π
        const buildingCosts = {
            castle: { stone: 2000, wood: 1000 },
            quarry: { stone: 1500, wood: 500 },
            mine: { stone: 1200, wood: 300 },
            factory: { stone: 3000, wood: 1500, steel: 200 },
            sawmill: { stone: 800, wood: 400 },
            villadiumMine: { stone: 2500, steel: 100 }
        };
        
        // Factory production speeds per level (units per hour per 250 peasants)
        const factorySpeeds = [
            0.1, 0.2, 0.3, 0.4, 0.5, 0.7, 0.9, 1.1, 1.3, 1.5,
            2, 2.5, 3, 3.5, 4, 5, 6, 7, 8, 9,
            11, 13, 15, 17, 19, 22, 25, 28, 31, 35,
            40, 45, 50, 55, 60, 70, 80, 90, 100, 125
        ];
        
        // Mining rates per worker per second
        const miningRates = {
            stone: 0.000694 / 60, // per second
            wood: 0.001042 / 60,
            ore: 0.000347 / 60,
            villadium: 0.000069 / 60
        };
        
        // Building max workers
        const buildingCapacity = {
            quarry: 13500,
            mine: 13500,
            sawmill: 13500,
            villadiumMine: 6750
        };
        
        // DOM elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const speedButtons = document.querySelectorAll('.speed-btn');
        const peasantsValueElement = document.querySelector('.peasants-value');
        const freePeasantsElements = document.querySelectorAll('#free-peasants, #mining-free-peasants, #recruit-free-peasants, #production-free-peasants');
        const assignedElements = {
            stone: document.getElementById('stone-assigned'),
            ore: document.getElementById('ore-assigned'),
            wood: document.getElementById('wood-assigned'),
            villadium: document.getElementById('villadium-assigned')
        };
        const miningButtons = document.querySelectorAll('.mining-btn');
        const factoryLevelElement = document.getElementById('factory-level');
        const productionLinesElement = document.getElementById('production-lines');
        const productionLinesContainer = document.getElementById('production-lines-container');
        
        // Update UI with game state
        function updateUI() {
            // Update resource values
            document.querySelector('.resource-value.stone').textContent = formatNumber(Math.round(gameState.resources.stone));
            document.querySelector('.resource-value.wood').textContent = formatNumber(Math.round(gameState.resources.wood));
            document.querySelector('.resource-value.ore').textContent = formatNumber(Math.round(gameState.resources.ore));
            document.querySelector('.resource-value.villadium').textContent = formatNumber(Math.round(gameState.resources.villadium));
            document.querySelectorAll('.resource-value')[4].textContent = formatNumber(Math.round(gameState.resources.iron));
            document.querySelectorAll('.resource-value')[5].textContent = formatNumber(Math.round(gameState.resources.copper));
            document.querySelectorAll('.resource-value')[6].textContent = formatNumber(Math.round(gameState.resources.coal));
            document.querySelectorAll('.resource-value')[7].textContent = formatNumber(Math.round(gameState.resources.acid));
            document.querySelectorAll('.resource-value')[8].textContent = formatNumber(Math.round(gameState.resources.steel));
            document.querySelectorAll('.resource-value')[9].textContent = formatNumber(Math.round(gameState.resources.electronicComponents));
            document.querySelectorAll('.resource-value')[10].textContent = formatNumber(Math.round(gameState.resources.accumulators));
            document.querySelectorAll('.resource-value')[11].textContent = formatNumber(Math.round(gameState.resources.villadiumFilters));
            
            // Update peasants
            peasantsValueElement.textContent = formatNumber(gameState.peasants.total);
            
            // Update assigned peasants
            assignedElements.stone.textContent = formatNumber(gameState.peasants.assigned.stone);
            assignedElements.ore.textContent = formatNumber(gameState.peasants.assigned.ore);
            assignedElements.wood.textContent = formatNumber(gameState.peasants.assigned.wood);
            assignedElements.villadium.textContent = formatNumber(gameState.peasants.assigned.villadium);
            
            // Update free peasants
            freePeasantsElements.forEach(el => {
                el.textContent = formatNumber(gameState.peasants.free);
            });
            
            // Update building levels
            document.querySelectorAll('.building-level').forEach(el => {
                const buildingName = el.closest('.building-card').querySelector('.building-name').textContent;
                const buildingKey = getBuildingKey(buildingName);
                el.textContent = `–£—Ä. ${gameState.buildings[buildingKey]}`;
            });
            
            // Update mining levels
            document.querySelectorAll('.mining-level').forEach(el => {
                const buildingName = el.closest('.mining-card').querySelector('.mining-name').textContent;
                const buildingKey = getBuildingKey(buildingName);
                el.textContent = `–£—Ä. ${gameState.buildings[buildingKey]}`;
            });
            
            // Update factory info
            factoryLevelElement.textContent = gameState.buildings.factory;
            productionLinesElement.textContent = gameState.productionLines.length;
            
            // Update production lines
            gameState.productionLines.forEach((line, index) => {
                const lineElement = productionLinesContainer.children[index];
                if (lineElement) {
                    const select = lineElement.querySelector('.recipe-select');
                    if (line.recipe) {
                        select.value = line.recipe;
                    }
                    
                    lineElement.querySelector('.line-assigned').textContent = formatNumber(line.assigned);
                    lineElement.querySelector('.line-progress').textContent = `${Math.round(line.progress * 100)}%`;
                }
            });
        }
        
        // Get building key from name
        function getBuildingKey(name) {
            const map = {
                '–ö–∞–º–µ–Ω–æ–ª–æ–º–Ω—è': 'quarry',
                '–®–∞—Ö—Ç–∞': 'mine',
                '–õ–µ—Å–æ–ø–∏–ª–∫–∞': 'sawmill',
                '–í–∏–ª–ª–∞–¥–∏—É–º–Ω–∞—è —à–∞—Ö—Ç–∞': 'villadiumMine',
                '–ó–∞–º–æ–∫': 'castle',
                '–§–∞–±—Ä–∏–∫–∞': 'factory'
            };
            return map[name];
        }
        
        // Format numbers for display
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // Assign peasants to mining
        function assignPeasants(resource, amount) {
            const buildingMap = {
                stone: 'quarry',
                ore: 'mine',
                wood: 'sawmill',
                villadium: 'villadiumMine'
            };
            
            const building = buildingMap[resource];
            const capacity = buildingCapacity[building] * gameState.buildings[building];
            
            let newAmount = gameState.peasants.assigned[resource] + amount;
            
            // Check bounds
            if (newAmount < 0) newAmount = 0;
            if (newAmount > capacity) newAmount = capacity;
            if (newAmount > gameState.peasants.assigned[resource] && 
                amount > gameState.peasants.free) {
                newAmount = gameState.peasants.assigned[resource] + gameState.peasants.free;
            }
            
            // Calculate difference
            const diff = newAmount - gameState.peasants.assigned[resource];
            
            // Update state
            gameState.peasants.assigned[resource] = newAmount;
            gameState.peasants.free -= diff;
            
            updateUI();
        }
        
        // Assign peasants to production line
        function assignToProduction(lineIndex, amount) {
            const line = gameState.productionLines[lineIndex];
            
            let newAmount = line.assigned + amount;
            
            // Check bounds
            if (newAmount < 0) newAmount = 0;
            if (newAmount > gameState.peasants.free + line.assigned) {
                newAmount = gameState.peasants.free + line.assigned;
            }
            
            // Calculate difference
            const diff = newAmount - line.assigned;
            
            // Update state
            line.assigned = newAmount;
            gameState.peasants.assigned.production += diff;
            gameState.peasants.free -= diff;
            
            updateUI();
        }
        
        // Change recipe for production line
        function changeRecipe(lineIndex, recipe) {
            gameState.productionLines[lineIndex].recipe = recipe;
            gameState.productionLines[lineIndex].progress = 0;
            updateUI();
        }
        
        // Get building cost
        function getBuildingCost(buildingKey, level) {
            const baseCost = buildingCosts[buildingKey];
            const cost = {};
            
            for (const [resource, amount] of Object.entries(baseCost)) {
                // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—Ç–æ–∏–º–æ—Å—Ç—å —Å —É—Ä–æ–≤–Ω–µ–º
                cost[resource] = Math.round(amount * Math.pow(1.5, level - 1));
            }
            
            return cost;
        }
        
        // Upgrade building
        function upgradeBuilding(buildingKey) {
            // Check if upgrade is possible (castle level)
            if (buildingKey !== 'castle' && 
                gameState.buildings[buildingKey] >= gameState.buildings.castle) {
                alert(`–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç! –°–Ω–∞—á–∞–ª–∞ —É–ª—É—á—à–∏—Ç–µ –∑–∞–º–æ–∫.`);
                return;
            }
            
            // Calculate cost for next level
            const cost = getBuildingCost(buildingKey, gameState.buildings[buildingKey]);
            
            // Check resources
            for (const [resource, amount] of Object.entries(cost)) {
                if (gameState.resources[resource] < amount) {
                    alert(`–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç ${resource} –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è. –¢—Ä–µ–±—É–µ—Ç—Å—è: ${formatNumber(amount)}, –∏–º–µ–µ—Ç—Å—è: ${formatNumber(gameState.resources[resource])}`);
                    return;
                }
            }
            
            // Spend resources
            for (const [resource, amount] of Object.entries(cost)) {
                gameState.resources[resource] -= amount;
            }
            
            // Upgrade building
            gameState.buildings[buildingKey]++;
            
            // Add new production line every 5 levels for factory
            if (buildingKey === 'factory' && gameState.buildings.factory % 5 === 0) {
                gameState.productionLines.push({
                    recipe: null,
                    assigned: 0,
                    progress: 0
                });
                renderProductionLines();
            }
            
            // Update peasants if castle upgraded
            if (buildingKey === 'castle') {
                const oldTotal = gameState.peasants.total;
                const newLevel = gameState.buildings.castle;
                
                if (newLevel - 1 < peasantsByCastleLevel.length) {
                    gameState.peasants.total = peasantsByCastleLevel[newLevel - 1];
                    gameState.peasants.free += (gameState.peasants.total - oldTotal);
                }
            }
            
            updateUI();
            alert(`–£–ª—É—á—à–µ–Ω–æ –∑–¥–∞–Ω–∏–µ: ${getBuildingName(buildingKey)} –¥–æ —É—Ä–æ–≤–Ω—è ${gameState.buildings[buildingKey]}`);
        }
        
        // Recruit army unit
        function recruitUnit() {
            const button = event.target;
            const unitType = button.getAttribute('data-unit');
            const amount = parseInt(button.getAttribute('data-amount'));
            
            // Find recipe card
            const recipeCard = button.closest('.recipe-card');
            const costItems = recipeCard.querySelectorAll('.cost-item');
            const costs = {};
            
            // Resource name mapping
            const resourceMap = {
                '–ö–æ–ø—å—è': 'spears',
                '–ê–ª–µ–±–∞—Ä–¥—ã': 'halberds',
                '–≠–ª. –∫–æ–ø—å—è': 'electricSpears',
                '–ñ–µ–ª–µ–∑–æ': 'iron',
                '–°—Ç–∞–ª—å': 'steel'
            };
            
            // Parse costs
            costItems.forEach(item => {
                const spans = item.querySelectorAll('span');
                const resourceName = spans[0].textContent.trim();
                const resourceKey = resourceMap[resourceName] || resourceName.toLowerCase();
                
                if (resourceName === '–ö—Ä–µ—Å—Ç—å—è–Ω–µ') {
                    // Already handled by amount
                    return;
                }
                
                const amountText = spans[1].textContent.trim().replace(/,/g, '');
                costs[resourceKey] = parseInt(amountText);
            });
            
            // Check free peasants
            if (gameState.peasants.free < amount) {
                alert(`–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∫—Ä–µ—Å—Ç—å—è–Ω! –¢—Ä–µ–±—É–µ—Ç—Å—è: ${formatNumber(amount)}, –¥–æ—Å—Ç—É–ø–Ω–æ: ${formatNumber(gameState.peasants.free)}`);
                return;
            }
            
            // Check resources
            for (const [resource, cost] of Object.entries(costs)) {
                if (gameState.resources[resource] === undefined || gameState.resources[resource] < cost) {
                    alert(`–ù–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ä–µ—Å—É—Ä—Å–∞: ${resource}! –¢—Ä–µ–±—É–µ—Ç—Å—è: ${formatNumber(cost)}, –∏–º–µ–µ—Ç—Å—è: ${formatNumber(gameState.resources[resource] || 0)}`);
                    return;
                }
            }
            
            // Spend resources
            for (const [resource, cost] of Object.entries(costs)) {
                gameState.resources[resource] -= cost;
            }
            
            // Recruit unit
            gameState.peasants.free -= amount;
            gameState.army[unitType] += amount;
            
            updateUI();
            alert(`–ù–∞–Ω—è—Ç–∞ –±–∞—Ç–∞–ª–∏—è: ${formatNumber(amount)} –≤–æ–∏–Ω–æ–≤!`);
        }
        
        // Get building name from key
        function getBuildingName(key) {
            const map = {
                'quarry': '–ö–∞–º–µ–Ω–æ–ª–æ–º–Ω—è',
                'mine': '–®–∞—Ö—Ç–∞',
                'sawmill': '–õ–µ—Å–æ–ø–∏–ª–∫–∞',
                'villadiumMine': '–í–∏–ª–ª–∞–¥–∏—É–º–Ω–∞—è —à–∞—Ö—Ç–∞',
                'castle': '–ó–∞–º–æ–∫',
                'factory': '–§–∞–±—Ä–∏–∫–∞'
            };
            return map[key];
        }
        
        // Render production lines
        function renderProductionLines() {
            productionLinesContainer.innerHTML = '';
            
            gameState.productionLines.forEach((line, index) => {
                const lineElement = document.createElement('div');
                lineElement.className = 'production-line';
                lineElement.innerHTML = `
                    <div class="line-header">
                        <div class="line-name">–õ–∏–Ω–∏—è #${index + 1}</div>
                    </div>
                    <select class="recipe-select" data-line="${index}">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—Ü–µ–ø—Ç</option>
                        <option value="steel">–°—Ç–∞–ª—å</option>
                        <option value="electronics">–≠–ª. –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã</option>
                        <option value="batteries">–ê–∫–∫—É–º—É–ª—è—Ç–æ—Ä—ã</option>
                        <option value="filters">–í–∏–ª–ª. —Ñ–∏–ª—å—Ç—Ä—ã</option>
                    </select>
                    <div class="mining-assigned">
                        <div class="cost-item">
                            <span>–ù–∞–∑–Ω–∞—á–µ–Ω–æ –∫—Ä–µ—Å—Ç—å—è–Ω:</span>
                            <span class="line-assigned">${formatNumber(line.assigned)}</span>
                        </div>
                        <div class="cost-item">
                            <span>–ü—Ä–æ–≥—Ä–µ—Å—Å:</span>
                            <span class="line-progress">${Math.round(line.progress * 100)}%</span>
                        </div>
                    </div>
                    <div class="mining-controls">
                        <button class="mining-btn" data-line="${index}" data-amount="-250">-250</button>
                        <button class="mining-btn" data-line="${index}" data-amount="-25">-25</button>
                        <button class="mining-btn" data-line="${index}" data-amount="25">+25</button>
                        <button class="mining-btn" data-line="${index}" data-amount="250">+250</button>
                    </div>
                `;
                productionLinesContainer.appendChild(lineElement);
                
                // Set selected recipe
                if (line.recipe) {
                    lineElement.querySelector(`.recipe-select`).value = line.recipe;
                }
                
                // Add event listener for recipe change
                lineElement.querySelector('.recipe-select').addEventListener('change', (e) => {
                    changeRecipe(index, e.target.value);
                });
                
                // Add event listeners for assignment buttons
                lineElement.querySelectorAll('.mining-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const amount = parseInt(button.getAttribute('data-amount'));
                        assignToProduction(index, amount);
                    });
                });
            });
        }
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and contents
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Speed control
        speedButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                speedButtons.forEach(b => b.classList.remove('active'));
                
                // Add active class to clicked button
                button.classList.add('active');
                
                // Update game speed
                gameState.speed = parseInt(button.getAttribute('data-speed'));
            });
        });
        
        // Upgrade buttons
        document.querySelectorAll('.upgrade-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                const buildingCard = event.target.closest('.building-card');
                const buildingName = buildingCard.querySelector('.building-name').textContent;
                const buildingKey = getBuildingKey(buildingName);
                upgradeBuilding(buildingKey);
            });
        });
        
        // Mining assignment buttons
        miningButtons.forEach(button => {
            button.addEventListener('click', () => {
                const resource = button.getAttribute('data-resource');
                const amount = parseInt(button.getAttribute('data-amount'));
                assignPeasants(resource, amount);
            });
        });
        
        // Recipe selection
        document.querySelectorAll('.recipe-select').forEach(select => {
            select.addEventListener('change', (e) => {
                const lineIndex = parseInt(e.target.getAttribute('data-line'));
                changeRecipe(lineIndex, e.target.value);
            });
        });
        
        // Production assignment buttons
        document.querySelectorAll('.mining-btn[data-line]').forEach(button => {
            button.addEventListener('click', () => {
                const lineIndex = parseInt(button.getAttribute('data-line'));
                const amount = parseInt(button.getAttribute('data-amount'));
                assignToProduction(lineIndex, amount);
            });
        });
        
        // Recruitment buttons
        document.querySelectorAll('.assign-btn').forEach(button => {
            button.addEventListener('click', recruitUnit);
        });
        
        // Initialize UI
        updateUI();
        renderProductionLines();
        
        // Game loop simulation
        setInterval(() => {
            // Resource production
            Object.keys(gameState.peasants.assigned).forEach(resource => {
                if (resource === 'production') return;
                
                const production = gameState.peasants.assigned[resource] * miningRates[resource] * gameState.speed;
                gameState.resources[resource] += production;
            });
            
            // Factory production
            const factoryLevel = gameState.buildings.factory;
            const baseSpeed = factorySpeeds[factoryLevel - 1] || 0.1;
            
            gameState.productionLines.forEach(line => {
                if (line.recipe && line.assigned > 0) {
                    // Calculate production per second (base speed is per hour per 250 peasants)
                    const productionPerSecond = (baseSpeed / 3600) * (line.assigned / 250) * gameState.speed;
                    
                    // Update progress
                    line.progress += productionPerSecond;
                    
                    // Check if a unit is completed
                    if (line.progress >= 1) {
                        const completedUnits = Math.floor(line.progress);
                        line.progress -= completedUnits;
                        
                        // Add resources based on recipe
                        switch (line.recipe) {
                            case 'steel':
                                gameState.resources.steel += completedUnits;
                                break;
                            case 'electronics':
                                gameState.resources.electronicComponents += completedUnits;
                                break;
                            case 'batteries':
                                gameState.resources.accumulators += completedUnits;
                                break;
                            case 'filters':
                                gameState.resources.villadiumFilters += completedUnits;
                                break;
                        }
                    }
                }
            });
            
            // Update UI
            updateUI();
        }, 1000); // Update every real-world second
    </script>
</body>
</html>
