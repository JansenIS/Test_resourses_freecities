<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Симулятор Развития Феода</title>
    <style>
        /* Стили остались без изменений */
        :root {
            --primary: #4a752c;
            --secondary: #8a9a5b;
            --dark: #2c3e21;
            --light: #e9f5db;
            --gold: #d4af37;
            --stone: #a9a9a9;
            --wood: #8b4513;
            --ore: #c1440e;
            --villadium: #6a0dad;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="%232c3e21"/><path d="M0,0 L100,100 M100,0 L0,100" stroke="%233a4b2c" stroke-width="1"/></svg>');
            color: var(--light);
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(43, 58, 32, 0.9);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }
        
        header {
            background: var(--dark);
            padding: 20px;
            text-align: center;
            border-bottom: 3px solid var(--gold);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            color: var(--gold);
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7);
        }
        
        .game-info {
            display: flex;
            justify-content: space-between;
            padding: 15px 20px;
            background: rgba(58, 78, 45, 0.8);
            border-bottom: 1px solid var(--secondary);
        }
        
        .time-controls {
            display: flex;
            gap: 10px;
        }
        
        .speed-btn {
            padding: 8px 15px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .speed-btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
        }
        
        .speed-btn.active {
            background: var(--gold);
            color: var(--dark);
        }
        
        .tabs {
            display: flex;
            background: var(--dark);
            border-bottom: 2px solid var(--gold);
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
            border-right: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tab:hover {
            background: rgba(106, 142, 74, 0.5);
        }
        
        .tab.active {
            background: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
            padding: 20px;
            min-height: 500px;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .resources-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .resource-card {
            background: rgba(69, 94, 54, 0.8);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s;
        }
        
        .resource-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.4);
        }
        
        .resource-icon {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .resource-name {
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: var(--gold);
        }
        
        .resource-value {
            font-size: 1.4rem;
            font-weight: bold;
        }
        
        .stone { color: var(--stone); }
        .wood { color: var(--wood); }
        .ore { color: var(--ore); }
        .villadium { color: var(--villadium); }
        
        .production-section, .building-section, .mining-section {
            background: rgba(58, 78, 45, 0.6);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        
        h2 {
            color: var(--gold);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary);
        }
        
        .building-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .building-card {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
        }
        
        .building-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .building-name {
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .building-level {
            background: var(--gold);
            color: var(--dark);
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .building-cost {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        
        .cost-item {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
        }
        
        .upgrade-btn {
            width: 100%;
            padding: 8px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .upgrade-btn:hover {
            background: var(--secondary);
        }
        
        .upgrade-btn:disabled {
            background: #555;
            cursor: not-allowed;
        }
        
        .assignment-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .assign-btn {
            flex: 1;
            padding: 5px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .peasants-info {
            background: rgba(106, 142, 74, 0.6);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }
        
        .peasants-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: var(--gold);
            margin: 10px 0;
        }
        
        .recipe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .recipe-card {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
        }
        
        .recipe-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .recipe-cost {
            margin: 10px 0;
        }
        
        .produce-btn {
            width: 100%;
            padding: 8px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .production-queue {
            margin-top: 30px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
        }
        
        .queue-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .progress-bar {
            height: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: var(--gold);
            width: 0%;
            transition: width 0.5s;
        }
        
        .mining-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .mining-card {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
        }
        
        .mining-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .mining-name {
            font-weight: bold;
            font-size: 1.2rem;
        }
        
        .mining-level {
            background: var(--gold);
            color: var(--dark);
            padding: 3px 8px;
            border-radius: 10px;
            font-weight: bold;
        }
        
        .mining-assigned {
            margin: 10px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
        }
        
        .mining-controls {
            display: flex;
            gap: 5px;
            margin-top: 10px;
        }
        
        .mining-btn {
            flex: 1;
            padding: 5px;
            background: var(--primary);
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        
        .production-line {
            background: rgba(43, 58, 32, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid var(--secondary);
            margin-bottom: 15px;
        }
        
        .line-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .line-name {
            font-weight: bold;
        }
        
        .recipe-select {
            width: 100%;
            padding: 5px;
            margin-bottom: 10px;
            background: rgba(0, 0, 0, 0.2);
            color: white;
            border: 1px solid var(--secondary);
            border-radius: 5px;
        }
        
        @media (max-width: 768px) {
            .resources-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .building-grid, .recipe-grid, .mining-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Симулятор Развития Феода</h1>
            <p>Управляйте своим доменом, развивайте производство и расширяйте владения</p>
        </header>
        
        <div class="game-info">
            <div class="time-controls">
                <button class="speed-btn active" data-speed="1">1x</button>
                <button class="speed-btn" data-speed="2">2x</button>
                <button class="speed-btn" data-speed="10">10x</button>
                <button class="speed-btn" data-speed="100">100x</button>
                <button class="speed-btn" data-speed="1000">1000x</button>
            </div>
        </div>
        
        <div class="tabs">
            <div class="tab active" data-tab="resources">Ресурсы</div>
            <div class="tab" data-tab="mining">Добыча</div>
            <div class="tab" data-tab="production">Производство</div>
            <div class="tab" data-tab="buildings">Строительство</div>
            <div class="tab" data-tab="recruitment">Найм</div>
        </div>
        
        <div class="tab-content active" id="resources-tab">
            <div class="peasants-info">
                <h3>Крестьяне</h3>
                <div class="peasants-value">30,000</div>
                <div>Свободные: <span id="free-peasants">30,000</span></div>
            </div>
            
            <h2>Основные ресурсы</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon stone">⛏️</div>
                    <div class="resource-name">Камень</div>
                    <div class="resource-value stone">1,250</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon wood">🌲</div>
                    <div class="resource-name">Лес</div>
                    <div class="resource-value wood">750</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon ore">🔶</div>
                    <div class="resource-name">Руда</div>
                    <div class="resource-value ore">500</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon villadium">💎</div>
                    <div class="resource-name">Вилладиум</div>
                    <div class="resource-value villadium">100</div>
                </div>
            </div>
            
            <h2>Материалы</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon">🔥</div>
                    <div class="resource-name">Железо</div>
                    <div class="resource-value">250</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">🟠</div>
                    <div class="resource-name">Медь</div>
                    <div class="resource-value">150</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">⬛</div>
                    <div class="resource-name">Уголь</div>
                    <div class="resource-value">200</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">🧪</div>
                    <div class="resource-name">Кислота</div>
                    <div class="resource-value">50</div>
                </div>
            </div>
            
            <h2>Компоненты</h2>
            <div class="resources-grid">
                <div class="resource-card">
                    <div class="resource-icon">🔩</div>
                    <div class="resource-name">Сталь</div>
                    <div class="resource-value">75</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">💻</div>
                    <div class="resource-name">Эл. компоненты</div>
                    <div class="resource-value">40</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">🔋</div>
                    <div class="resource-name">Аккумуляторы</div>
                    <div class="resource-value">25</div>
                </div>
                
                <div class="resource-card">
                    <div class="resource-icon">⚙️</div>
                    <div class="resource-name">Вилл. фильтры</div>
                    <div class="resource-value">10</div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="mining-tab">
            <div class="mining-section">
                <div class="peasants-info">
                    <h3>Распределение крестьян</h3>
                    <div class="peasants-value">30,000</div>
                    <div>Свободные: <span id="mining-free-peasants">30,000</span></div>
                </div>
                
                <h2>Добыча ресурсов</h2>
                <div class="mining-grid">
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">Каменоломня</div>
                            <div class="mining-level">Ур. 1</div>
                        </div>
                        <p>Добывает камень для строительства</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>Назначено:</span>
                                <span id="stone-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>Максимум:</span>
                                <span>13,500</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="stone" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="stone" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="stone" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="stone" data-amount="2500">+2500</button>
                        </div>
                    </div>
                    
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">Шахта</div>
                            <div class="mining-level">Ур. 1</div>
                        </div>
                        <p>Добывает руду для производства</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>Назначено:</span>
                                <span id="ore-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>Максимум:</span>
                                <span>13,500</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="ore" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="ore" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="ore" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="ore" data-amount="2500">+2500</button>
                        </div>
                    </div>
                    
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">Лесопилка</div>
                            <div class="mining-level">Ур. 1</div>
                        </div>
                        <p>Добывает древесину и производит уголь</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>Назначено:</span>
                                <span id="wood-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>Максимум:</span>
                                <span>13,500</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="wood" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="wood" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="wood" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="wood" data-amount="2500">+2500</button>
                        </div>
                    </div>
                    
                    <div class="mining-card">
                        <div class="mining-header">
                            <div class="mining-name">Вилладиумная шахта</div>
                            <div class="mining-level">Ур. 1</div>
                        </div>
                        <p>Добывает вилладиум, редкий ресурс</p>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>Назначено:</span>
                                <span id="villadium-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>Максимум:</span>
                                <span>6,750</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-resource="villadium" data-amount="-2500">-2500</button>
                            <button class="mining-btn" data-resource="villadium" data-amount="-250">-250</button>
                            <button class="mining-btn" data-resource="villadium" data-amount="250">+250</button>
                            <button class="mining-btn" data-resource="villadium" data-amount="2500">+2500</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="production-tab">
            <div class="production-section">
                <div class="peasants-info">
                    <h3>Фабрика (Уровень: <span id="factory-level">1</span>)</h3>
                    <div class="peasants-value">30,000</div>
                    <div>Свободные: <span id="production-free-peasants">30,000</span></div>
                    <div>Производственные линии: <span id="production-lines">1</span></div>
                </div>
                
                <h2>Производственные линии</h2>
                <div id="production-lines-container">
                    <div class="production-line">
                        <div class="line-header">
                            <div class="line-name">Линия #1</div>
                        </div>
                        <select class="recipe-select" data-line="0">
                            <option value="">Выберите рецепт</option>
                            <option value="steel">Сталь</option>
                            <option value="electronics">Эл. компоненты</option>
                            <option value="batteries">Аккумуляторы</option>
                            <option value="filters">Вилл. фильтры</option>
                        </select>
                        <div class="mining-assigned">
                            <div class="cost-item">
                                <span>Назначено крестьян:</span>
                                <span class="line-assigned">0</span>
                            </div>
                            <div class="cost-item">
                                <span>Прогресс:</span>
                                <span class="line-progress">0%</span>
                            </div>
                        </div>
                        <div class="mining-controls">
                            <button class="mining-btn" data-line="0" data-amount="-250">-250</button>
                            <button class="mining-btn" data-line="0" data-amount="-25">-25</button>
                            <button class="mining-btn" data-line="0" data-amount="25">+25</button>
                            <button class="mining-btn" data-line="0" data-amount="250">+250</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="production-section">
                <h2>Рецепты производства</h2>
                <div class="recipe-grid">
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Сталь</div>
                            <div class="recipe-output">1 единица</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Железо:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>Уголь:</span>
                                <span>5</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>Время на 250 крестьян:</span>
                            <span>10 часов</span>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Эл. компоненты</div>
                            <div class="recipe-output">1 единица</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Железо:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>Медь:</span>
                                <span>5</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>Время на 250 крестьан:</span>
                            <span>10 часов</span>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Аккумуляторы</div>
                            <div class="recipe-output">1 единица</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Кислота:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>Медь:</span>
                                <span>20</span>
                            </div>
                            <div class="cost-item">
                                <span>Уголь:</span>
                                <span>5</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>Время на 250 крестьан:</span>
                            <span>10 часов</span>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Вилл. фильтры</div>
                            <div class="recipe-output">1 единица</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Вилладиум:</span>
                                <span>5</span>
                            </div>
                            <div class="cost-item">
                                <span>Уголь:</span>
                                <span>1</span>
                            </div>
                        </div>
                        <div class="cost-item">
                            <span>Время на 250 крестьан:</span>
                            <span>10 часов</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="buildings-tab">
            <div class="building-section">
                <h2>Здания феода</h2>
                <div class="building-grid">
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">Замок</div>
                            <div class="building-level">Ур. 1</div>
                        </div>
                        <p>Центр управления феодом. Максимальный уровень других зданий равен уровню замка.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>Камень:</span>
                                <span>2,000</span>
                            </div>
                            <div class="cost-item">
                                <span>Лес:</span>
                                <span>1,000</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">Улучшить до ур. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">Каменоломня</div>
                            <div class="building-level">Ур. 1</div>
                        </div>
                        <p>Добывает камень для строительства и улучшения зданий.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>Камень:</span>
                                <span>1,500</span>
                            </div>
                            <div class="cost-item">
                                <span>Лес:</span>
                                <span>500</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">Улучшить до ур. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">Шахта</div>
                            <div class="building-level">Ур. 1</div>
                        </div>
                        <p>Добывает руду для производства металлов.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>Камень:</span>
                                <span>1,200</span>
                            </div>
                            <div class="cost-item">
                                <span>Лес:</span>
                                <span>300</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">Улучшить до ур. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">Фабрика</div>
                            <div class="building-level">Ур. 1</div>
                        </div>
                        <p>Производит сложные материалы и компоненты.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>Камень:</span>
                                <span>3,000</span>
                            </div>
                            <div class="cost-item">
                                <span>Лес:</span>
                                <span>1,500</span>
                            </div>
                            <div class="cost-item">
                                <span>Сталь:</span>
                                <span>200</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">Улучшить до ур. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">Лесопилка</div>
                            <div class="building-level">Ур. 1</div>
                        </div>
                        <p>Добывает древесину и производит уголь.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>Камень:</span>
                                <span>800</span>
                            </div>
                            <div class="cost-item">
                                <span>Лес:</span>
                                <span>400</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">Улучшить до ур. 2</button>
                    </div>
                    
                    <div class="building-card">
                        <div class="building-header">
                            <div class="building-name">Вилладиумная шахта</div>
                            <div class="building-level">Ур. 1</div>
                        </div>
                        <p>Добывает вилладиум, редкий энергетический ресурс.</p>
                        <div class="building-cost">
                            <div class="cost-item">
                                <span>Камень:</span>
                                <span>2,500</span>
                            </div>
                            <div class="cost-item">
                                <span>Сталь:</span>
                                <span>100</span>
                            </div>
                        </div>
                        <button class="upgrade-btn">Улучшить до ур. 2</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="tab-content" id="recruitment-tab">
            <div class="peasants-info">
                <h3>Распределение крестьян</h3>
                <div class="peasants-value">30,000</div>
                <div>Свободные: <span id="recruit-free-peasants">30,000</span></div>
            </div>
            
            <div class="production-section">
                <h2>Найм войск</h2>
                <div class="recipe-grid">
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Крестьянская баталия</div>
                            <div class="recipe-output">30,000 крестьян</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Крестьяне:</span>
                                <span>30,000</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="peasant" data-amount="30000">Нанять баталию</button>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Поместная баталия</div>
                            <div class="recipe-output">22,500 воинов</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Крестьяне:</span>
                                <span>22,500</span>
                            </div>
                            <div class="cost-item">
                                <span>Копья:</span>
                                <span>100</span>
                            </div>
                            <div class="cost-item">
                                <span>Железо:</span>
                                <span>50</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="warrior1" data-amount="22500">Нанять баталию</button>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Доменная баталия</div>
                            <div class="recipe-output">15,000 воинов</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Крестьяне:</span>
                                <span>15,000</span>
                            </div>
                            <div class="cost-item">
                                <span>Алебарды:</span>
                                <span>50</span>
                            </div>
                            <div class="cost-item">
                                <span>Сталь:</span>
                                <span>30</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="warrior2" data-amount="15000">Нанять баталию</button>
                        </div>
                    </div>
                    
                    <div class="recipe-card">
                        <div class="recipe-header">
                            <div class="recipe-name">Копье ландфрида</div>
                            <div class="recipe-output">7,500 воинов</div>
                        </div>
                        <div class="recipe-cost">
                            <div class="cost-item">
                                <span>Крестьяне:</span>
                                <span>7,500</span>
                            </div>
                            <div class="cost-item">
                                <span>Эл. копья:</span>
                                <span>20</span>
                            </div>
                            <div class="cost-item">
                                <span>Сталь:</span>
                                <span>50</span>
                            </div>
                        </div>
                        <div class="assignment-controls">
                            <button class="assign-btn" data-unit="warrior3" data-amount="7500">Нанять баталию</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state
        const gameState = {
            resources: {
                stone: 1250,
                wood: 750,
                ore: 500,
                villadium: 100,
                iron: 250,
                copper: 150,
                coal: 200,
                acid: 50,
                steel: 75,
                electronicComponents: 40,
                accumulators: 25,
                villadiumFilters: 10
            },
            peasants: {
                total: 30000,
                free: 30000,
                assigned: {
                    stone: 0,
                    wood: 0,
                    ore: 0,
                    villadium: 0,
                    production: 0
                }
            },
            buildings: {
                castle: 1,
                quarry: 1,
                mine: 1,
                factory: 1,
                sawmill: 1,
                villadiumMine: 1
            },
            productionLines: [
                {
                    recipe: null,
                    assigned: 0,
                    progress: 0
                }
            ],
            army: {
                peasant: 0,
                warrior1: 0,
                warrior2: 0,
                warrior3: 0
            },
            speed: 1
        };
        
        // Количество крестьян по уровням замка (из CSV)
        const peasantsByCastleLevel = [
            30000, 42000, 42250, 42500, 42750, 43000, 43500, 44000, 44500, 45000,
            46000, 47000, 48000, 49000, 50000, 52000, 54000, 56000, 58000, 60000,
            63000, 66000, 69000, 72000, 75000, 80000, 85000, 90000, 95000, 100000,
            130000, 160000, 190000, 220000, 250000, 300000, 350000, 400000, 450000, 500000
        ];
        
        // Стоимость улучшений зданий
        const buildingCosts = {
            castle: { stone: 2000, wood: 1000 },
            quarry: { stone: 1500, wood: 500 },
            mine: { stone: 1200, wood: 300 },
            factory: { stone: 3000, wood: 1500, steel: 200 },
            sawmill: { stone: 800, wood: 400 },
            villadiumMine: { stone: 2500, steel: 100 }
        };
        
        // Factory production speeds per level (units per hour per 250 peasants)
        const factorySpeeds = [
            0.1, 0.2, 0.3, 0.4, 0.5, 0.7, 0.9, 1.1, 1.3, 1.5,
            2, 2.5, 3, 3.5, 4, 5, 6, 7, 8, 9,
            11, 13, 15, 17, 19, 22, 25, 28, 31, 35,
            40, 45, 50, 55, 60, 70, 80, 90, 100, 125
        ];
        
        // Mining rates per worker per second
        const miningRates = {
            stone: 0.000694 / 60, // per second
            wood: 0.001042 / 60,
            ore: 0.000347 / 60,
            villadium: 0.000069 / 60
        };
        
        // Building max workers
        const buildingCapacity = {
            quarry: 13500,
            mine: 13500,
            sawmill: 13500,
            villadiumMine: 6750
        };
        
        // DOM elements
        const tabs = document.querySelectorAll('.tab');
        const tabContents = document.querySelectorAll('.tab-content');
        const speedButtons = document.querySelectorAll('.speed-btn');
        const peasantsValueElement = document.querySelector('.peasants-value');
        const freePeasantsElements = document.querySelectorAll('#free-peasants, #mining-free-peasants, #recruit-free-peasants, #production-free-peasants');
        const assignedElements = {
            stone: document.getElementById('stone-assigned'),
            ore: document.getElementById('ore-assigned'),
            wood: document.getElementById('wood-assigned'),
            villadium: document.getElementById('villadium-assigned')
        };
        const miningButtons = document.querySelectorAll('.mining-btn');
        const factoryLevelElement = document.getElementById('factory-level');
        const productionLinesElement = document.getElementById('production-lines');
        const productionLinesContainer = document.getElementById('production-lines-container');
        
        // Update UI with game state
        function updateUI() {
            // Update resource values
            document.querySelector('.resource-value.stone').textContent = formatNumber(Math.round(gameState.resources.stone));
            document.querySelector('.resource-value.wood').textContent = formatNumber(Math.round(gameState.resources.wood));
            document.querySelector('.resource-value.ore').textContent = formatNumber(Math.round(gameState.resources.ore));
            document.querySelector('.resource-value.villadium').textContent = formatNumber(Math.round(gameState.resources.villadium));
            document.querySelectorAll('.resource-value')[4].textContent = formatNumber(Math.round(gameState.resources.iron));
            document.querySelectorAll('.resource-value')[5].textContent = formatNumber(Math.round(gameState.resources.copper));
            document.querySelectorAll('.resource-value')[6].textContent = formatNumber(Math.round(gameState.resources.coal));
            document.querySelectorAll('.resource-value')[7].textContent = formatNumber(Math.round(gameState.resources.acid));
            document.querySelectorAll('.resource-value')[8].textContent = formatNumber(Math.round(gameState.resources.steel));
            document.querySelectorAll('.resource-value')[9].textContent = formatNumber(Math.round(gameState.resources.electronicComponents));
            document.querySelectorAll('.resource-value')[10].textContent = formatNumber(Math.round(gameState.resources.accumulators));
            document.querySelectorAll('.resource-value')[11].textContent = formatNumber(Math.round(gameState.resources.villadiumFilters));
            
            // Update peasants
            peasantsValueElement.textContent = formatNumber(gameState.peasants.total);
            
            // Update assigned peasants
            assignedElements.stone.textContent = formatNumber(gameState.peasants.assigned.stone);
            assignedElements.ore.textContent = formatNumber(gameState.peasants.assigned.ore);
            assignedElements.wood.textContent = formatNumber(gameState.peasants.assigned.wood);
            assignedElements.villadium.textContent = formatNumber(gameState.peasants.assigned.villadium);
            
            // Update free peasants
            freePeasantsElements.forEach(el => {
                el.textContent = formatNumber(gameState.peasants.free);
            });
            
            // Update building levels
            document.querySelectorAll('.building-level').forEach(el => {
                const buildingName = el.closest('.building-card').querySelector('.building-name').textContent;
                const buildingKey = getBuildingKey(buildingName);
                el.textContent = `Ур. ${gameState.buildings[buildingKey]}`;
            });
            
            // Update mining levels
            document.querySelectorAll('.mining-level').forEach(el => {
                const buildingName = el.closest('.mining-card').querySelector('.mining-name').textContent;
                const buildingKey = getBuildingKey(buildingName);
                el.textContent = `Ур. ${gameState.buildings[buildingKey]}`;
            });
            
            // Update factory info
            factoryLevelElement.textContent = gameState.buildings.factory;
            productionLinesElement.textContent = gameState.productionLines.length;
            
            // Update production lines
            gameState.productionLines.forEach((line, index) => {
                const lineElement = productionLinesContainer.children[index];
                if (lineElement) {
                    const select = lineElement.querySelector('.recipe-select');
                    if (line.recipe) {
                        select.value = line.recipe;
                    }
                    
                    lineElement.querySelector('.line-assigned').textContent = formatNumber(line.assigned);
                    lineElement.querySelector('.line-progress').textContent = `${Math.round(line.progress * 100)}%`;
                }
            });
        }
        
        // Get building key from name
        function getBuildingKey(name) {
            const map = {
                'Каменоломня': 'quarry',
                'Шахта': 'mine',
                'Лесопилка': 'sawmill',
                'Вилладиумная шахта': 'villadiumMine',
                'Замок': 'castle',
                'Фабрика': 'factory'
            };
            return map[name];
        }
        
        // Format numbers for display
        function formatNumber(num) {
            return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // Assign peasants to mining
        function assignPeasants(resource, amount) {
            const buildingMap = {
                stone: 'quarry',
                ore: 'mine',
                wood: 'sawmill',
                villadium: 'villadiumMine'
            };
            
            const building = buildingMap[resource];
            const capacity = buildingCapacity[building] * gameState.buildings[building];
            
            let newAmount = gameState.peasants.assigned[resource] + amount;
            
            // Check bounds
            if (newAmount < 0) newAmount = 0;
            if (newAmount > capacity) newAmount = capacity;
            if (newAmount > gameState.peasants.assigned[resource] && 
                amount > gameState.peasants.free) {
                newAmount = gameState.peasants.assigned[resource] + gameState.peasants.free;
            }
            
            // Calculate difference
            const diff = newAmount - gameState.peasants.assigned[resource];
            
            // Update state
            gameState.peasants.assigned[resource] = newAmount;
            gameState.peasants.free -= diff;
            
            updateUI();
        }
        
        // Assign peasants to production line
        function assignToProduction(lineIndex, amount) {
            const line = gameState.productionLines[lineIndex];
            
            let newAmount = line.assigned + amount;
            
            // Check bounds
            if (newAmount < 0) newAmount = 0;
            if (newAmount > gameState.peasants.free + line.assigned) {
                newAmount = gameState.peasants.free + line.assigned;
            }
            
            // Calculate difference
            const diff = newAmount - line.assigned;
            
            // Update state
            line.assigned = newAmount;
            gameState.peasants.assigned.production += diff;
            gameState.peasants.free -= diff;
            
            updateUI();
        }
        
        // Change recipe for production line
        function changeRecipe(lineIndex, recipe) {
            gameState.productionLines[lineIndex].recipe = recipe;
            gameState.productionLines[lineIndex].progress = 0;
            updateUI();
        }
        
        // Get building cost
        function getBuildingCost(buildingKey, level) {
            const baseCost = buildingCosts[buildingKey];
            const cost = {};
            
            for (const [resource, amount] of Object.entries(baseCost)) {
                // Увеличиваем стоимость с уровнем
                cost[resource] = Math.round(amount * Math.pow(1.5, level - 1));
            }
            
            return cost;
        }
        
        // Upgrade building
        function upgradeBuilding(buildingKey) {
            // Check if upgrade is possible (castle level)
            if (buildingKey !== 'castle' && 
                gameState.buildings[buildingKey] >= gameState.buildings.castle) {
                alert(`Максимальный уровень достигнут! Сначала улучшите замок.`);
                return;
            }
            
            // Calculate cost for next level
            const cost = getBuildingCost(buildingKey, gameState.buildings[buildingKey]);
            
            // Check resources
            for (const [resource, amount] of Object.entries(cost)) {
                if (gameState.resources[resource] < amount) {
                    alert(`Не хватает ${resource} для улучшения. Требуется: ${formatNumber(amount)}, имеется: ${formatNumber(gameState.resources[resource])}`);
                    return;
                }
            }
            
            // Spend resources
            for (const [resource, amount] of Object.entries(cost)) {
                gameState.resources[resource] -= amount;
            }
            
            // Upgrade building
            gameState.buildings[buildingKey]++;
            
            // Add new production line every 5 levels for factory
            if (buildingKey === 'factory' && gameState.buildings.factory % 5 === 0) {
                gameState.productionLines.push({
                    recipe: null,
                    assigned: 0,
                    progress: 0
                });
                renderProductionLines();
            }
            
            // Update peasants if castle upgraded
            if (buildingKey === 'castle') {
                const oldTotal = gameState.peasants.total;
                const newLevel = gameState.buildings.castle;
                
                if (newLevel - 1 < peasantsByCastleLevel.length) {
                    gameState.peasants.total = peasantsByCastleLevel[newLevel - 1];
                    gameState.peasants.free += (gameState.peasants.total - oldTotal);
                }
            }
            
            updateUI();
            alert(`Улучшено здание: ${getBuildingName(buildingKey)} до уровня ${gameState.buildings[buildingKey]}`);
        }
        
        // Recruit army unit
        function recruitUnit() {
            const button = event.target;
            const unitType = button.getAttribute('data-unit');
            const amount = parseInt(button.getAttribute('data-amount'));
            
            // Find recipe card
            const recipeCard = button.closest('.recipe-card');
            const costItems = recipeCard.querySelectorAll('.cost-item');
            const costs = {};
            
            // Resource name mapping
            const resourceMap = {
                'Копья': 'spears',
                'Алебарды': 'halberds',
                'Эл. копья': 'electricSpears',
                'Железо': 'iron',
                'Сталь': 'steel'
            };
            
            // Parse costs
            costItems.forEach(item => {
                const spans = item.querySelectorAll('span');
                const resourceName = spans[0].textContent.trim();
                const resourceKey = resourceMap[resourceName] || resourceName.toLowerCase();
                
                if (resourceName === 'Крестьяне') {
                    // Already handled by amount
                    return;
                }
                
                const amountText = spans[1].textContent.trim().replace(/,/g, '');
                costs[resourceKey] = parseInt(amountText);
            });
            
            // Check free peasants
            if (gameState.peasants.free < amount) {
                alert(`Не хватает свободных крестьян! Требуется: ${formatNumber(amount)}, доступно: ${formatNumber(gameState.peasants.free)}`);
                return;
            }
            
            // Check resources
            for (const [resource, cost] of Object.entries(costs)) {
                if (gameState.resources[resource] === undefined || gameState.resources[resource] < cost) {
                    alert(`Не хватает ресурса: ${resource}! Требуется: ${formatNumber(cost)}, имеется: ${formatNumber(gameState.resources[resource] || 0)}`);
                    return;
                }
            }
            
            // Spend resources
            for (const [resource, cost] of Object.entries(costs)) {
                gameState.resources[resource] -= cost;
            }
            
            // Recruit unit
            gameState.peasants.free -= amount;
            gameState.army[unitType] += amount;
            
            updateUI();
            alert(`Нанята баталия: ${formatNumber(amount)} воинов!`);
        }
        
        // Get building name from key
        function getBuildingName(key) {
            const map = {
                'quarry': 'Каменоломня',
                'mine': 'Шахта',
                'sawmill': 'Лесопилка',
                'villadiumMine': 'Вилладиумная шахта',
                'castle': 'Замок',
                'factory': 'Фабрика'
            };
            return map[key];
        }
        
        // Render production lines
        function renderProductionLines() {
            productionLinesContainer.innerHTML = '';
            
            gameState.productionLines.forEach((line, index) => {
                const lineElement = document.createElement('div');
                lineElement.className = 'production-line';
                lineElement.innerHTML = `
                    <div class="line-header">
                        <div class="line-name">Линия #${index + 1}</div>
                    </div>
                    <select class="recipe-select" data-line="${index}">
                        <option value="">Выберите рецепт</option>
                        <option value="steel">Сталь</option>
                        <option value="electronics">Эл. компоненты</option>
                        <option value="batteries">Аккумуляторы</option>
                        <option value="filters">Вилл. фильтры</option>
                    </select>
                    <div class="mining-assigned">
                        <div class="cost-item">
                            <span>Назначено крестьян:</span>
                            <span class="line-assigned">${formatNumber(line.assigned)}</span>
                        </div>
                        <div class="cost-item">
                            <span>Прогресс:</span>
                            <span class="line-progress">${Math.round(line.progress * 100)}%</span>
                        </div>
                    </div>
                    <div class="mining-controls">
                        <button class="mining-btn" data-line="${index}" data-amount="-250">-250</button>
                        <button class="mining-btn" data-line="${index}" data-amount="-25">-25</button>
                        <button class="mining-btn" data-line="${index}" data-amount="25">+25</button>
                        <button class="mining-btn" data-line="${index}" data-amount="250">+250</button>
                    </div>
                `;
                productionLinesContainer.appendChild(lineElement);
                
                // Set selected recipe
                if (line.recipe) {
                    lineElement.querySelector(`.recipe-select`).value = line.recipe;
                }
                
                // Add event listener for recipe change
                lineElement.querySelector('.recipe-select').addEventListener('change', (e) => {
                    changeRecipe(index, e.target.value);
                });
                
                // Add event listeners for assignment buttons
                lineElement.querySelectorAll('.mining-btn').forEach(button => {
                    button.addEventListener('click', () => {
                        const amount = parseInt(button.getAttribute('data-amount'));
                        assignToProduction(index, amount);
                    });
                });
            });
        }
        
        // Tab switching
        tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                // Remove active class from all tabs and contents
                tabs.forEach(t => t.classList.remove('active'));
                tabContents.forEach(c => c.classList.remove('active'));
                
                // Add active class to clicked tab and corresponding content
                tab.classList.add('active');
                const tabId = tab.getAttribute('data-tab');
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // Speed control
        speedButtons.forEach(button => {
            button.addEventListener('click', () => {
                // Remove active class from all buttons
                speedButtons.forEach(b => b.classList.remove('active'));
                
                // Add active class to clicked button
                button.classList.add('active');
                
                // Update game speed
                gameState.speed = parseInt(button.getAttribute('data-speed'));
            });
        });
        
        // Upgrade buttons
        document.querySelectorAll('.upgrade-btn').forEach(button => {
            button.addEventListener('click', (event) => {
                const buildingCard = event.target.closest('.building-card');
                const buildingName = buildingCard.querySelector('.building-name').textContent;
                const buildingKey = getBuildingKey(buildingName);
                upgradeBuilding(buildingKey);
            });
        });
        
        // Mining assignment buttons
        miningButtons.forEach(button => {
            button.addEventListener('click', () => {
                const resource = button.getAttribute('data-resource');
                const amount = parseInt(button.getAttribute('data-amount'));
                assignPeasants(resource, amount);
            });
        });
        
        // Recipe selection
        document.querySelectorAll('.recipe-select').forEach(select => {
            select.addEventListener('change', (e) => {
                const lineIndex = parseInt(e.target.getAttribute('data-line'));
                changeRecipe(lineIndex, e.target.value);
            });
        });
        
        // Production assignment buttons
        document.querySelectorAll('.mining-btn[data-line]').forEach(button => {
            button.addEventListener('click', () => {
                const lineIndex = parseInt(button.getAttribute('data-line'));
                const amount = parseInt(button.getAttribute('data-amount'));
                assignToProduction(lineIndex, amount);
            });
        });
        
        // Recruitment buttons
        document.querySelectorAll('.assign-btn').forEach(button => {
            button.addEventListener('click', recruitUnit);
        });
        
        // Initialize UI
        updateUI();
        renderProductionLines();
        
        // Game loop simulation
        setInterval(() => {
            // Resource production
            Object.keys(gameState.peasants.assigned).forEach(resource => {
                if (resource === 'production') return;
                
                const production = gameState.peasants.assigned[resource] * miningRates[resource] * gameState.speed;
                gameState.resources[resource] += production;
            });
            
            // Factory production
            const factoryLevel = gameState.buildings.factory;
            const baseSpeed = factorySpeeds[factoryLevel - 1] || 0.1;
            
            gameState.productionLines.forEach(line => {
                if (line.recipe && line.assigned > 0) {
                    // Calculate production per second (base speed is per hour per 250 peasants)
                    const productionPerSecond = (baseSpeed / 3600) * (line.assigned / 250) * gameState.speed;
                    
                    // Update progress
                    line.progress += productionPerSecond;
                    
                    // Check if a unit is completed
                    if (line.progress >= 1) {
                        const completedUnits = Math.floor(line.progress);
                        line.progress -= completedUnits;
                        
                        // Add resources based on recipe
                        switch (line.recipe) {
                            case 'steel':
                                gameState.resources.steel += completedUnits;
                                break;
                            case 'electronics':
                                gameState.resources.electronicComponents += completedUnits;
                                break;
                            case 'batteries':
                                gameState.resources.accumulators += completedUnits;
                                break;
                            case 'filters':
                                gameState.resources.villadiumFilters += completedUnits;
                                break;
                        }
                    }
                }
            });
            
            // Update UI
            updateUI();
        }, 1000); // Update every real-world second
    </script>
</body>
</html>
